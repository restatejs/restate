!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Restate=t():(e.Restate=e.Restate||{},e.Restate.collectionModel=t())}(this,(()=>(()=>{"use strict";var e={589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=void 0;const s=r(734);t.Resource=class{constructor(){this.state=(0,s.reactive)({data:{}})}get(e){return this.state.data[e]||(this.state.data[e]=void 0),(0,s.toRef)(this.state.data,e)}getAll(){return(0,s.computed)((()=>Object.values(this.state.data)))}set(e,t){return this.state.data[e]=t,(0,s.toRef)(this.state.data,e)}setProperty(e,t,r){const o=this.state.data[e];if(!o)throw new Error("Property not updated.");return o[t]=r,(0,s.toRef)(this.state.data,e)}has(e){return e in this.state.data}delete(e){delete this.state.data[e]}clear(){this.state.data={}}}},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});r(752).__exportStar(r(589),t)},93:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreModel=void 0;const s=r(607);t.CoreModel=class{constructor(e){this.$resourceName=e,this.$resource=new s.Resource}}},583:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HTTPModel=void 0;const s=r(149),o=r(93);class a extends o.CoreModel{constructor({resourceName:e,axios:t,afterRequest:r}){super(e),this.$axios=t,this.$afterRequest=r}request(e,t,r){return(0,s.load)((async()=>{const{data:r}=await this.$axios.request({url:e,method:t?.method,params:t?.query,data:t?.data});this.$afterRequest&&await this.$afterRequest(r),t?.afterRequest&&await t.afterRequest(r)}),r)}}t.HTTPModel=a},149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;const s=r(734);t.load=function(e,t){const r=(0,s.ref)(!0),o={loaded:(async()=>(await e(),r.value=!1,!0))(),loading:r};return t&&(o.data=t),o}},752:e=>{e.exports=require("tslib")},734:e=>{e.exports=require("vue")}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}var s={};return(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0}),e.CollectionModel=void 0;const t=r(734),o=r(583);class a extends o.HTTPModel{constructor({resourceName:e,primaryKey:t,axios:r,computedProperties:s={}}){super({resourceName:e,axios:r}),this.$primaryKey=t,this.$computedProperties=new Map(Object.entries(s))}data(e){const{sort:r,filter:s}=e??{};let o=this.$resource.getAll();return(s||r)&&(o=(0,t.computed)((()=>{let e=[...o.value];if(s&&(e="function"==typeof s?e.filter(s):e.filter(((e,t,r)=>!s.map((s=>s(e,t,r))).includes(!1)))),r){const t="function"==typeof r?r:(e,t)=>`${e[r]}`.localeCompare(`${t[r]}`);e.sort(t)}return e}))),o}item(e){return this.$resource.get(e)}index(e){const t=this.$resource.getAll();return this.request(`/${this.$resourceName}`,{method:"GET",query:e?.query,afterRequest:t=>{!1!==e?.clear&&this.$resource.clear(),t.forEach((e=>{const t=this.$resource.set(e[this.$primaryKey],e);this.$insertComputedProperties(t)}))}},t)}show(e,t){const r=this.$resource.get(e);return this.request(`/${this.$resourceName}/${e}`,{method:"GET",query:t?.query,afterRequest:t=>{this.$resource.set(e,t),this.$insertComputedProperties(r)}},r)}store(e,r){const s=(0,t.ref)(null),o=(0,t.computed)((()=>{if(null!==s.value)return this.$resource.get(s.value).value}));return this.request(`/${this.$resourceName}`,{method:"POST",query:r?.query,data:e,afterRequest:t=>{const r=this.$resource.set(e[this.$primaryKey],t);s.value=e[this.$primaryKey],this.$insertComputedProperties(r)}},o)}update(e,t,r){return this.request(`/${this.$resourceName}/${e}`,{method:"PUT",query:r?.query,data:t,afterRequest:()=>{Object.entries(t).forEach((([t,r])=>{this.$resource.setProperty(e,t,r)}))}})}destroy(e,t){return this.request(`/${this.$resourceName}/${e}`,{method:"DELETE",query:t?.query,afterRequest:()=>this.$resource.delete(e)})}$insertComputedProperties(e){this.$computedProperties.forEach(((r,s)=>{e.value[s]=(0,t.computed)((()=>r(e)))}))}}e.CollectionModel=a})(),s})()));