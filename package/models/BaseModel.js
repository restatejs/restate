!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Restate=t():(e.Restate=e.Restate||{},e.Restate.baseModel=t())}(this,(()=>(()=>{"use strict";var e={589:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=void 0;const r=s(734);t.Resource=class{constructor(){this.state=(0,r.reactive)({data:{}})}get(e){return void 0===this.state.data[e]&&this.set(e,{}),(0,r.toRef)(this.state.data,e)}getAll(){return(0,r.computed)((()=>Object.values(this.state.data)))}set(e,t){return this.state.data[e]=(0,r.ref)(t),this}setProperty(e,t,s){const r=this.state.data[e];return r&&Reflect.set(r,t,s),this}has(e){return e in this.state.data}delete(e){delete this.state.data[e]}clear(){this.state.data={}}}},607:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});s(752).__exportStar(s(589),t)},93:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreModel=void 0;const r=s(734),o=s(607);t.CoreModel=class{constructor(e){this.$resourceName=e,this.$resource=new o.Resource}load(e){const t=(0,r.ref)(!0);return{loaded:(async()=>(await e(),t.value=!1,!0))(),loading:t}}}},752:e=>{e.exports=require("tslib")},734:e=>{e.exports=require("vue")}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,s),a.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.BaseModel=void 0;const t=s(734),o=s(93);function a(e,t,s){let r=e.replace(/(\/:\w+)/g,(e=>{const s=e.slice(2);if(!t[s])throw new Error;return`/${t[s]}`}));return s&&(r+=`?${new URLSearchParams(s)}`),r}class i extends o.CoreModel{constructor(e,t){super(e),this.$resourceName=e,this.$axios=t,this.$pk="id"}collection(){return this.$resource.getAll()}item(e){return this.$resource.get(e)}index(e){const t=a("/:resourceName",{resourceName:this.$resourceName},e?.query),{loaded:s,loading:r}=this.load((async()=>{const{data:s}=await this.$axios.get(t);!0!==e?.merge&&this.$resource.clear(),s.forEach((e=>this.$resource.set(e[this.$pk],e)))}));return{data:this.$resource.getAll(),loaded:s,loading:r}}show(e,t){const s=a("/:resourceName/:id",{resourceName:this.$resourceName,id:e},t?.query),{loaded:r,loading:o}=this.load((async()=>{const{data:t}=await this.$axios.get(s);this.$resource.set(e,t)}));return{data:this.$resource.get(e),loaded:r,loading:o}}store(e,s){const r=a("/:resourceName",{resourceName:this.$resourceName},s?.query),o=(0,t.ref)(null),i=(0,t.computed)((()=>null===o.value?null:this.$resource.get(o.value).value)),{loaded:u,loading:c}=this.load((async()=>{const{data:t}=await this.$axios.post(r,e);this.$resource.set(t[this.$pk],t),o.value=t[this.$pk]}));return{data:i,loaded:u,loading:c}}update(e,t,s){const r=a("/:resourceName/:id",{resourceName:this.$resourceName,id:e},s?.query);return this.load((async()=>{await this.$axios.put(r,t),Object.entries(t).forEach((([t,s])=>this.$resource.setProperty(e,t,s)))}))}destroy(e,t){const s=a("/:resourceName/:id",{resourceName:this.$resourceName,id:e},t?.query);return this.load((async()=>{await this.$axios.delete(s),this.$resource.delete(e)}))}}e.BaseModel=i})(),r})()));