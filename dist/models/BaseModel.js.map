{"version":3,"file":"models/BaseModel.js","mappings":"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","sources":["webpack://Restate.[name]/webpack/universalModuleDefinition","webpack://Restate.[name]/webpack/runtime/chunk loaded","webpack://Restate.[name]/./src/models/BaseModel.ts","webpack://Restate.[name]/./src/models/CoreModel.ts","webpack://Restate.[name]/webpack/bootstrap","webpack://Restate.[name]/webpack/runtime/hasOwnProperty shorthand","webpack://Restate.[name]/webpack/runtime/jsonp chunk loading","webpack://Restate.[name]/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Restate\"] = factory();\n\telse\n\t\troot[\"Restate\"] = root[\"Restate\"] || {}, root[\"Restate\"][\"baseModel\"] = factory();\n})(this, function() {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","import type {\n  IndexOptions,\n  ShowOptions,\n  StoreOptions,\n  UpdateOptions,\n  DestroyOptions,\n} from \"types/models/BaseModel\";\nimport type { IPK } from \"types/Restate\";\n\nimport type Restate from \"..\";\n\nimport { CoreModel } from \"./CoreModel\";\n\nfunction createURL(\n  pattern: string,\n  params: Record<string, string | number>,\n  query?: Record<string, string | number>\n): string {\n  const regExp = /(\\/:\\w+)/g;\n\n  let url = pattern.replace(regExp, (match) => {\n    const paramKey = match.slice(2);\n\n    if (!params[paramKey]) {\n      throw new Error();\n    }\n\n    return `/${params[paramKey]}`;\n  });\n\n  if (query) {\n    url += `?${new URLSearchParams(query as Record<string, string>)}`;\n  }\n\n  return url;\n}\n\nclass BaseModel<RI> extends CoreModel<RI> {\n  public $pk = \"id\";\n\n  constructor(public $resourceName: string, public $restate: Restate) {\n    super($resourceName, $restate);\n  }\n\n  public async index(options?: IndexOptions): Promise<RI[]> {\n    const url = createURL(\n      \"/:resourceName\",\n      { resourceName: this.$resourceName },\n      options?.query\n    );\n\n    const reponseData = await this.$httpClient.get<RI[]>(url);\n\n    if (options?.merge !== true) {\n      this.$resource.clear();\n    }\n\n    reponseData.forEach((item: any) =>\n      this.$resource.set(item[this.$pk], item)\n    );\n\n    return this.$resource.getAll();\n  }\n\n  public async show(id: IPK, options?: ShowOptions): Promise<RI | undefined> {\n    const url = createURL(\n      \"/:resourceName/:id\",\n      { resourceName: this.$resourceName, id },\n      options?.query\n    );\n\n    const reponseData = await this.$httpClient.get<RI>(url);\n\n    this.$resource.set((reponseData as any)[this.$pk], reponseData);\n\n    return this.$resource.get(id);\n  }\n\n  public async store(\n    data: Partial<RI>,\n    options?: StoreOptions\n  ): Promise<boolean> {\n    const url = createURL(\n      \"/:resourceName\",\n      { resourceName: this.$resourceName },\n      options?.query\n    );\n\n    const reponseData = await this.$httpClient.post<RI>(url, data);\n\n    this.$resource.set((reponseData as any)[this.$pk], reponseData);\n\n    return true;\n  }\n\n  public async update(\n    id: IPK,\n    data: Partial<RI>,\n    options?: UpdateOptions\n  ): Promise<boolean> {\n    const url = createURL(\n      \"/:resourceName/:id\",\n      { resourceName: this.$resourceName, id },\n      options?.query\n    );\n\n    await this.$httpClient.put(url, data);\n\n    Object.entries(data).forEach(([key, val]) =>\n      this.$resource.setProperty(id, key, val)\n    );\n\n    return true;\n  }\n\n  public async destroy(id: IPK, options?: DestroyOptions): Promise<boolean> {\n    const url = createURL(\n      \"/:resourceName/:id\",\n      { resourceName: this.$resourceName, id },\n      options?.query\n    );\n\n    await this.$httpClient.delete(url);\n\n    this.$resource.delete(id);\n\n    return true;\n  }\n}\n\nexport { BaseModel };\n","import type { IHTTPClient, IResource } from \"types\";\n\nimport type Restate from \"..\";\n\nclass CoreModel<RI = any> {\n  public $resource: IResource<RI>;\n\n  public $httpClient: IHTTPClient;\n\n  constructor(public $resourceName: string, public $restate: Restate) {\n    if ($restate.has($resourceName)) {\n      throw new Error(\n        `RESTATE ERROR: there is already a Model that the resource name is '${$resourceName}'`\n      );\n    }\n\n    $restate.set($resourceName, this);\n\n    this.$httpClient = $restate.httpClient;\n\n    if (!this.$restate.store.has($resourceName)) {\n      this.$resource = this.$restate.store.add<RI>($resourceName);\n    } else {\n      this.$resource = this.$restate.store.get<RI>($resourceName);\n    }\n  }\n}\n\nexport { CoreModel };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t431: 0,\n\t608: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = this[\"webpackChunkRestate_name_\"] = this[\"webpackChunkRestate_name_\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(560);\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["root","factory","exports","module","define","amd","this","deferred","createURL","pattern","params","query","url","replace","match","paramKey","slice","Error","URLSearchParams","BaseModel","CoreModel","constructor","$resourceName","$restate","super","$pk","async","options","resourceName","reponseData","$httpClient","get","merge","$resource","clear","forEach","item","set","getAll","id","data","post","put","Object","entries","key","val","setProperty","delete","has","httpClient","store","add","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","length","fulfilled","j","keys","every","splice","r","o","obj","prop","prototype","hasOwnProperty","call","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","bind","push","__webpack_exports__"],"sourceRoot":""}